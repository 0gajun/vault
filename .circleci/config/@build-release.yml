### GENERATED BY .circleci/config/@build-release.yml; DO NOT MANUALLY EDIT OR MERGE THIS FILE

# Any change to $cacheVersion invalidates all build layer and package caches.
# Current $cacheVersion: buildcache-v1

workflows:
  build-release:
    jobs:
      - cache-builder-images:
          filters:
            branches:
              only:
                - /build-.*/
                - /ci.*/
      - package_darwin_386: { requires: [ cache-builder-images ] }
      - package_darwin_amd64: { requires: [ cache-builder-images ] }
      - bundle-releases:
          requires:
            - package_darwin_386
            - package_darwin_amd64
jobs:
  cache-builder-images:
    executor: releaser
    steps:
      - setup_remote_docker
      - checkout
      - write-cache-keys
      - restore_cache:
          keys:
            - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}
            - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}
            - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}
            - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}
      - run: make -f release/layer.mk static_091b1f3a3673094f9fec6c536decbaabc947f8a8-load || echo "No cached builder image to load."
      - run: make -f release/layer.mk static_091b1f3a3673094f9fec6c536decbaabc947f8a8-image
      - run: make -f release/layer.mk static_091b1f3a3673094f9fec6c536decbaabc947f8a8-save
      - save_cache:
          key: buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}
          paths:
            - .buildcache/archives/static_091b1f3a3673094f9fec6c536decbaabc947f8a8.tar.gz

  bundle-releases:
    executor: releaser
    steps:
      - checkout
      - write-cache-keys
      - "load-package_darwin_386"
      - "load-package_darwin_amd64"
      - run: ls -lahR dist/
  package_darwin_386:
    executor: releaser
    environment:
      - PACKAGE_SPEC_ID: 44cd0406d177aa0d653c55b3f9b66a700938a3f1
      - PRODUCT_REVISION: v1.2.1
      - BINARY_NAME: 'vault'
      - BUILDER_LAYER_ID: 'static_091b1f3a3673094f9fec6c536decbaabc947f8a8'
      - BUILD_JOB_NAME: 'package_darwin_386'
      - BUILD_TAGS: 'vault'
      - BUNDLE_NAME: 'vault_1.2.1-testbuild-sam'
      - CGOENABLED: '0'
      - GO111MODULE: 'off'
      - GOARCH: '386'
      - GOOS: 'darwin'
      - GO_VERSION: '1.12.13'
      - PACKAGE_NAME: 'vault_1.2.1-testbuild-sam_darwin_386'
      - PACKAGE_OUT_ROOT: 'dist/public/vault_1.2.1-testbuild-sam'
      - PRODUCT_EDITION: ''
      - PRODUCT_NAME: 'vault'
      - PRODUCT_VERSION: '1.2.1-testbuild-sam'
      - PRODUCT_VERSION_MMP: '1.2.1'
      - PRODUCT_VERSION_PRE: 'testbuild-sam'
      - PUBLIC: 'YES'
      - YARN_VERSION: '1.17.3-1'
    steps:
      - setup_remote_docker
      - checkout
      - write-cache-keys
      - restore_cache:
          keys:
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}
      - restore_cache:
          key: 'package-{{checksum ".buildcache/cache-keys/package-44cd0406d177aa0d653c55b3f9b66a700938a3f1"}}'
      - run: make -f release/layer.mk static_091b1f3a3673094f9fec6c536decbaabc947f8a8-load || echo "No cached builder image to load."
      - run: make -C release package
      - run: ls -lahR dist/
      - store_artifacts:
          path: dist/public/vault_1.2.1-testbuild-sam
          destination: dist/public/vault_1.2.1-testbuild-sam
      # Save builder image cache.
      - save_cache:
          key: 'buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}'
          paths:
            - .buildcache/archives/static_091b1f3a3673094f9fec6c536decbaabc947f8a8.tar.gz
      # Save package cache.
      - save_cache:
          key: 'package-{{checksum ".buildcache/cache-keys/package-44cd0406d177aa0d653c55b3f9b66a700938a3f1"}}'
          paths:
            - dist/public/vault_1.2.1-testbuild-sam

  package_darwin_amd64:
    executor: releaser
    environment:
      - PACKAGE_SPEC_ID: ff293baf407ea656d95d8c0356de5115b5a3ea96
      - PRODUCT_REVISION: v1.2.1
      - BINARY_NAME: 'vault'
      - BUILDER_LAYER_ID: 'static_091b1f3a3673094f9fec6c536decbaabc947f8a8'
      - BUILD_JOB_NAME: 'package_darwin_amd64'
      - BUILD_TAGS: 'vault'
      - BUNDLE_NAME: 'vault_1.2.1-testbuild-sam'
      - CGOENABLED: '0'
      - GO111MODULE: 'off'
      - GOARCH: 'amd64'
      - GOOS: 'darwin'
      - GO_VERSION: '1.12.13'
      - PACKAGE_NAME: 'vault_1.2.1-testbuild-sam_darwin_amd64'
      - PACKAGE_OUT_ROOT: 'dist/public/vault_1.2.1-testbuild-sam'
      - PRODUCT_EDITION: ''
      - PRODUCT_NAME: 'vault'
      - PRODUCT_VERSION: '1.2.1-testbuild-sam'
      - PRODUCT_VERSION_MMP: '1.2.1'
      - PRODUCT_VERSION_PRE: 'testbuild-sam'
      - PUBLIC: 'YES'
      - YARN_VERSION: '1.17.3-1'
    steps:
      - setup_remote_docker
      - checkout
      - write-cache-keys
      - restore_cache:
          keys:
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}
          - buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}
      - restore_cache:
          key: 'package-{{checksum ".buildcache/cache-keys/package-ff293baf407ea656d95d8c0356de5115b5a3ea96"}}'
      - run: make -f release/layer.mk static_091b1f3a3673094f9fec6c536decbaabc947f8a8-load || echo "No cached builder image to load."
      - run: make -C release package
      - run: ls -lahR dist/
      - store_artifacts:
          path: dist/public/vault_1.2.1-testbuild-sam
          destination: dist/public/vault_1.2.1-testbuild-sam
      # Save builder image cache.
      - save_cache:
          key: 'buildcache-v1-base_2a2d27b4f4e5e0e7f4cde990163e75d7241f5060-{{ checksum ".buildcache/cache-keys/base-2a2d27b4f4e5e0e7f4cde990163e75d7241f5060" }}-yarn_c3b21faa96145772075659b497ccc60a2a69464b-{{ checksum ".buildcache/cache-keys/yarn-c3b21faa96145772075659b497ccc60a2a69464b" }}-ui_3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf-{{ checksum ".buildcache/cache-keys/ui-3a8c4bff60eb05e71d903b7fef5a0fb6f2de62bf" }}-static_091b1f3a3673094f9fec6c536decbaabc947f8a8-{{ checksum ".buildcache/cache-keys/static-091b1f3a3673094f9fec6c536decbaabc947f8a8" }}'
          paths:
            - .buildcache/archives/static_091b1f3a3673094f9fec6c536decbaabc947f8a8.tar.gz
      # Save package cache.
      - save_cache:
          key: 'package-{{checksum ".buildcache/cache-keys/package-ff293baf407ea656d95d8c0356de5115b5a3ea96"}}'
          paths:
            - dist/public/vault_1.2.1-testbuild-sam


